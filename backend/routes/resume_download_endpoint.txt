// Add this new route to profileRoutes.js to download resumes from database

// @desc    Download resume
// @route   GET /api/profile/resume/:userId
// @access  Private (interviewer can view candidate resumes)
router.get('/resume/:userId', protect, async (req, res) => {
    try {
        const user = await User.findById(req.params.userId);
        
        if (!user || !user.resumeContent) {
            return res.status(404).json({ message: 'Resume not found' });
        }

        // Convert Base64 back to buffer
        const resumeBuffer = Buffer.from(user.resumeContent, 'base64');
        
        // Set headers for file download
        res.setHeader('Content-Type', user.resumeMimeType || 'application/pdf');
        res.setHeader('Content-Disposition', `inline; filename="${user.resumeFileName || 'resume.pdf'}"`);
        res.send(resumeBuffer);
    } catch (error) {
        console.error('Resume download error:', error);
        res.status(500).json({ message: 'Failed to download resume' });
    }
});
